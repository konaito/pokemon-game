<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Monster Chronicle - 図鑑</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&family=Press+Start+2P&display=swap");

      :root {
        --bg-main: #1a1a2e;
        --bg-panel: #16213e;
        --bg-card: #0f3460;
        --accent: #e94560;
        --accent-glow: rgba(233, 69, 96, 0.3);
        --border: rgba(83, 52, 131, 0.5);
        --text-primary: #ffffff;
        --text-secondary: #cbd5e1;
        --text-muted: #64748b;

        --type-normal: #a8a878;
        --type-fire: #f08030;
        --type-water: #6890f0;
        --type-grass: #78c850;
        --type-electric: #f8d030;
        --type-ice: #98d8d8;
        --type-fighting: #c03028;
        --type-poison: #a040a0;
        --type-ground: #e0c068;
        --type-flying: #a890f0;
        --type-psychic: #f85888;
        --type-bug: #a8b820;
        --type-rock: #b8a038;
        --type-ghost: #705898;
        --type-dragon: #7038f8;
        --type-dark: #705848;
        --type-steel: #b8b8d0;
        --type-fairy: #ee99ac;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: var(--bg-main);
        color: var(--text-primary);
        font-family: "Noto Sans JP", sans-serif;
        min-height: 100vh;
      }

      /* Header */
      .header {
        background: linear-gradient(135deg, var(--bg-panel), var(--bg-card));
        border-bottom: 2px solid var(--border);
        padding: 2rem;
        text-align: center;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
      }
      .header h1 {
        font-family: "Press Start 2P", monospace;
        font-size: 1.5rem;
        color: var(--accent);
        text-shadow: 0 0 20px var(--accent-glow);
        margin-bottom: 0.5rem;
      }
      .header p {
        color: var(--text-secondary);
        font-size: 0.85rem;
      }

      /* Filter */
      .filter-bar {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4rem;
        justify-content: center;
        margin-top: 1rem;
      }
      .filter-btn {
        font-family: "Noto Sans JP", sans-serif;
        font-size: 0.7rem;
        font-weight: 700;
        padding: 0.3rem 0.7rem;
        border-radius: 999px;
        border: 1.5px solid rgba(255, 255, 255, 0.15);
        background: rgba(255, 255, 255, 0.05);
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.2s;
      }
      .filter-btn:hover,
      .filter-btn.active {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.4);
        color: #fff;
      }
      .filter-btn.active {
        box-shadow: 0 0 8px rgba(255, 255, 255, 0.1);
      }

      /* Grid */
      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1rem;
        padding: 1.5rem;
        max-width: 1400px;
        margin: 0 auto;
      }

      /* Card */
      .card {
        background: linear-gradient(135deg, var(--bg-panel), var(--bg-card));
        border: 2px solid var(--border);
        border-radius: 12px;
        overflow: hidden;
        transition:
          transform 0.2s,
          box-shadow 0.2s;
        cursor: pointer;
        position: relative;
      }
      .card:hover {
        transform: translateY(-4px);
        box-shadow:
          0 8px 30px rgba(0, 0, 0, 0.4),
          0 0 20px var(--accent-glow);
        border-color: rgba(233, 69, 96, 0.4);
      }
      .card.legendary {
        border-color: rgba(248, 208, 48, 0.5);
      }
      .card.legendary:hover {
        box-shadow:
          0 8px 30px rgba(0, 0, 0, 0.4),
          0 0 20px rgba(248, 208, 48, 0.3);
      }

      .card-top {
        display: flex;
        align-items: center;
        padding: 1rem;
        gap: 1rem;
      }
      .sprite-container {
        flex-shrink: 0;
        width: 80px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 12px;
      }
      .card-info {
        flex: 1;
        min-width: 0;
      }
      .card-number {
        font-family: "Press Start 2P", monospace;
        font-size: 0.55rem;
        color: var(--text-muted);
      }
      .card-name {
        font-size: 1.1rem;
        font-weight: 900;
        margin: 0.2rem 0;
      }
      .card-id {
        font-size: 0.7rem;
        color: var(--text-muted);
        font-style: italic;
      }
      .types {
        display: flex;
        gap: 0.3rem;
        margin-top: 0.4rem;
      }
      .type-badge {
        font-size: 0.65rem;
        font-weight: 700;
        padding: 0.15rem 0.6rem;
        border-radius: 999px;
        color: #fff;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
      }

      /* Stats */
      .stats {
        padding: 0 1rem 0.8rem;
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 0.3rem;
      }
      .stat {
        text-align: center;
      }
      .stat-label {
        font-size: 0.5rem;
        font-weight: 700;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      .stat-value {
        font-size: 0.8rem;
        font-weight: 900;
      }
      .stat-bar {
        height: 3px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
        margin-top: 2px;
        overflow: hidden;
      }
      .stat-fill {
        height: 100%;
        border-radius: 2px;
        transition: width 0.5s ease;
      }
      .stat-total {
        text-align: center;
        font-size: 0.65rem;
        color: var(--text-muted);
        padding: 0 1rem 0.6rem;
      }
      .stat-total span {
        font-weight: 900;
        color: var(--text-secondary);
      }

      /* Evolution */
      .evolution {
        padding: 0 1rem 0.8rem;
        font-size: 0.7rem;
        color: var(--text-muted);
      }
      .evolution .evo-arrow {
        color: var(--accent);
        font-weight: 700;
      }
      .evolution .evo-name {
        color: var(--text-secondary);
        font-weight: 700;
      }

      /* Legend badge */
      .legend-badge {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        font-family: "Press Start 2P", monospace;
        font-size: 0.45rem;
        padding: 0.2rem 0.5rem;
        background: linear-gradient(135deg, #f8d030, #e0c068);
        color: #1a1a2e;
        border-radius: 4px;
      }

      /* Empty state */
      .empty {
        grid-column: 1 / -1;
        text-align: center;
        padding: 4rem 2rem;
        color: var(--text-muted);
        font-size: 1.1rem;
      }

      /* Animations */
      .card {
        animation: fadeIn 0.3s ease forwards;
        opacity: 0;
      }
      @keyframes fadeIn {
        to {
          opacity: 1;
        }
      }

      /* Stat color helper */
      .stat-high {
        color: #34d399;
      }
      .stat-mid {
        color: #fbbf24;
      }
      .stat-low {
        color: #ef4444;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>MONSTER CHRONICLE</h1>
      <p>全50種 モンスター図鑑</p>
      <div class="filter-bar" id="filterBar"></div>
    </div>

    <div class="grid" id="monsterGrid"></div>

    <script>
      // ─── Type Data ───
      const TYPE_HEX = {
        normal: "#A8A878",
        fire: "#F08030",
        water: "#6890F0",
        grass: "#78C850",
        electric: "#F8D030",
        ice: "#98D8D8",
        fighting: "#C03028",
        poison: "#A040A0",
        ground: "#E0C068",
        flying: "#A890F0",
        psychic: "#F85888",
        bug: "#A8B820",
        rock: "#B8A038",
        ghost: "#705898",
        dragon: "#7038F8",
        dark: "#705848",
        steel: "#B8B8D0",
        fairy: "#EE99AC",
      };

      const TYPE_LABEL = {
        normal: "ノーマル",
        fire: "ほのお",
        water: "みず",
        grass: "くさ",
        electric: "でんき",
        ice: "こおり",
        fighting: "かくとう",
        poison: "どく",
        ground: "じめん",
        flying: "ひこう",
        psychic: "エスパー",
        bug: "むし",
        rock: "いわ",
        ghost: "ゴースト",
        dragon: "ドラゴン",
        dark: "あく",
        steel: "はがね",
        fairy: "フェアリー",
      };

      // ─── Color Helpers ───
      function lightenColor(hex, amount) {
        const r = Math.min(255, parseInt(hex.slice(1, 3), 16) + amount);
        const g = Math.min(255, parseInt(hex.slice(3, 5), 16) + amount);
        const b = Math.min(255, parseInt(hex.slice(5, 7), 16) + amount);
        return `#${r.toString(16).padStart(2, "0")}${g.toString(16).padStart(2, "0")}${b.toString(16).padStart(2, "0")}`;
      }
      function darkenColor(hex, amount) {
        const r = Math.max(0, parseInt(hex.slice(1, 3), 16) - amount);
        const g = Math.max(0, parseInt(hex.slice(3, 5), 16) - amount);
        const b = Math.max(0, parseInt(hex.slice(5, 7), 16) - amount);
        return `#${r.toString(16).padStart(2, "0")}${g.toString(16).padStart(2, "0")}${b.toString(16).padStart(2, "0")}`;
      }

      function getTypeColor(types) {
        return TYPE_HEX[types[0]] || "#A8A878";
      }
      function getSecondaryColor(types) {
        if (types.length > 1) return TYPE_HEX[types[1]] || "#A8A878";
        return lightenColor(TYPE_HEX[types[0]] || "#A8A878", 40);
      }

      // ─── Pixel Sprite Data ───
      const SPRITE_DATA = {
        himori: {
          palette: { 4: "#FFCC00", 5: "#FF6030" },
          grid: [
            ".......55...........",
            "......5553..........",
            ".....55553..........",
            "......11............",
            ".....1111...........",
            "....111111..........",
            "....1w11w1..........",
            "....111111..........",
            "....111411..........",
            ".....1111...........",
            "....111111..........",
            "...11111111.........",
            "...11111111.........",
            "...11111111.........",
            "...31111133.........",
            "...3.1111.3.........",
            ".....3..3...........",
            ".....3..3...........",
            "....................",
            "....................",
          ],
        },
        hinomori: {
          palette: { 4: "#FFCC00", 5: "#FF6030" },
          grid: [
            "......555...........",
            ".....55553..........",
            "....555553..........",
            ".....1111...........",
            "....111111..........",
            "...11111111.........",
            "...1w1111w1.........",
            "...11111111.........",
            "...11144111.........",
            "....111111..........",
            "...1111111..........",
            "..1111111111........",
            "..1111111111........",
            "..1111111111........",
            "..3111111113........",
            "..3..1111..3........",
            ".....33.33..........",
            ".....3...3..........",
            "....................",
            "....................",
          ],
        },
        enjuu: {
          palette: { 4: "#FFCC00", 5: "#FF4020", 6: "#C03028" },
          grid: [
            ".....5555...........",
            "....555553..........",
            "...5555553..........",
            "....61116...........",
            "...11111111.........",
            "..1111111111........",
            "..1w111111w1........",
            "..1161111611........",
            "..1111441111........",
            "...11111111.........",
            "..111111111.........",
            ".11111111111........",
            ".11111111111........",
            ".111111111113.......",
            ".3111111111.3.......",
            ".3.31111133.........",
            "...33..333..........",
            "...3....3...........",
            "...3....3...........",
            "....................",
          ],
        },
        shizukumo: {
          palette: { 4: "#B3E5FC" },
          grid: [
            "....................",
            "......4444..........",
            ".....111111.........",
            "....11111111........",
            "....1w1111w1........",
            "....11111111........",
            "....11111111........",
            ".....111111.........",
            "...3111111113.......",
            "..31111111113.......",
            "..33111111133.......",
            "...31111113.........",
            "....111111..........",
            "....111111..........",
            ".....1111...........",
            ".....3333...........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        namikozou: {
          palette: { 4: "#B3E5FC" },
          grid: [
            ".......44...........",
            "......4444..........",
            ".....111111.........",
            "....11111111........",
            "...1111111111.......",
            "...1w11111w11.......",
            "...11111111111......",
            "...11111111111......",
            "....11111111........",
            "..3311111111133.....",
            ".333111111111333....",
            "..331111111133......",
            "...111111111........",
            "...111111111........",
            "....1111111.........",
            "....33...33.........",
            "....3.....3.........",
            "....................",
            "....................",
            "....................",
          ],
        },
        taikaiou: {
          palette: { 4: "#B3E5FC", 5: "#F85888" },
          grid: [
            "......2222..........",
            ".....222222.........",
            "....11111111........",
            "...1111111111.......",
            "..11111111111.......",
            "..1w51111w511.......",
            "..111111111111......",
            "..111111111111......",
            "...111441111........",
            "..1111111111........",
            ".311111111113.......",
            ".3111111111113......",
            "..31111111113.......",
            "..311111111113......",
            "...3111111113.......",
            "...33.1111.33.......",
            "......3333..........",
            "......3..3..........",
            "....................",
            "....................",
          ],
        },
        konohana: {
          palette: { 4: "#4CAF50", 5: "#A5D6A7", 6: "#66BB6A" },
          grid: [
            ".......66...........",
            "......6556..........",
            ".....44..44.........",
            ".....111111.........",
            "....11111111........",
            "....1w1111w1........",
            "....11111111........",
            "....11111111........",
            ".....111111.........",
            "....11111111........",
            "....11111111........",
            "....11111111........",
            "....11111111........",
            ".....111111.........",
            "......1111..........",
            "......3333..........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        morinoko: {
          palette: { 4: "#388E3C", 5: "#66BB6A", 6: "#A5D6A7" },
          grid: [
            ".......55...........",
            "......5555..........",
            "...44.1111.44.......",
            "...4411111144.......",
            "....11111111........",
            "...1111111111.......",
            "...1w11111w11.......",
            "...11111111111......",
            "...11111111111......",
            "....111111111.......",
            "...1111111111.......",
            "...1116611111.......",
            "...1116611111.......",
            "...11111111111......",
            "....111111111.......",
            ".....33..33.........",
            ".....3....3.........",
            "....................",
            "....................",
            "....................",
          ],
        },
        taijushin: {
          palette: { 4: "#388E3C", 5: "#66BB6A", 6: "#B8A038" },
          grid: [
            "......555...........",
            ".....55555..........",
            "..44.11111.44.......",
            "..441111111144......",
            "...1111111111.......",
            "..11111111111.......",
            "..1w111111w111......",
            "..111111111111......",
            "..111111111111......",
            "...1112211111.......",
            "..11111111111.......",
            ".1111111111111......",
            ".1111111111111......",
            ".1111111111111......",
            ".33111111111133.....",
            ".33..111111.33......",
            "......3333..........",
            "......33.33.........",
            "......3...3.........",
            "....................",
          ],
        },
        konezumi: {
          palette: { 4: "#FFB6C1" },
          grid: [
            "....................",
            "......11.11.........",
            ".....11..11.........",
            ".....111111.........",
            "....11111111........",
            "....1w1111w1........",
            "....11111111........",
            "....11141111........",
            ".....111111.........",
            "....11111111........",
            "....11111111........",
            "....11111111.111....",
            ".....111111.11111...",
            "......3333..11111...",
            "......3..3...111....",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        oonezumi: {
          palette: { 4: "#C03028" },
          grid: [
            ".....22..22.........",
            "....221..122........",
            "....11111111........",
            "...1111111111.......",
            "...1w41111w411......",
            "...11111111111......",
            "...11111111111......",
            "....111111111.......",
            "...11111111111......",
            "...1111111111111....",
            "...111111111111111..",
            "...1111111111..1111.",
            "....11111111...111..",
            ".....333333.........",
            ".....3....3.........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        tobibato: {
          palette: { 4: "#F8D030" },
          grid: [
            "....................",
            "....................",
            "......1111..........",
            ".....111111.........",
            "....1w1111w1........",
            "....11111111........",
            "....11141111........",
            ".....111111.........",
            "..2211111122........",
            ".22211111122........",
            ".222111111222.......",
            "..2.111111.2........",
            ".....1111...........",
            ".....1111...........",
            "......33............",
            "......33............",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        hayatedori: {
          palette: { 4: "#F8D030" },
          grid: [
            ".......22...........",
            "......2222..........",
            ".....111111.........",
            "....11111111........",
            "....1w1111w1........",
            "....11111111........",
            "....1113111.........",
            ".....111111.........",
            ".22211111112........",
            "2222111111122.......",
            "22221111111222......",
            ".222.11111.222......",
            "......1111..........",
            ".....111111.........",
            ".....33..33.........",
            ".....3....3.........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        mayumushi: {
          palette: {},
          grid: [
            "....................",
            "....................",
            "......1111..........",
            ".....111111.........",
            "....1w1111w1........",
            "....11111111........",
            "....11111111........",
            ".....111111.........",
            "....11111111........",
            "...3111111113.......",
            "..33.111111.33......",
            "..3..111111..3......",
            ".....111111.........",
            "......1111..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        hanamushi: {
          palette: { 4: "#FF69B4", 5: "#7038F8" },
          grid: [
            "......444...........",
            ".....44444..........",
            "......111...........",
            ".....111111.........",
            "....11111111........",
            "....1w5111w5........",
            "....11111111........",
            ".....111111.........",
            "..2211111122........",
            ".22211111122........",
            ".222111111222.......",
            ".222.11111.222......",
            "......1111..........",
            "......1111..........",
            ".......33...........",
            ".......33...........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        hikarineko: {
          palette: { 4: "#FFEB3B", 5: "#FFF176" },
          grid: [
            "....11....11........",
            "...111...111........",
            "...1111.1111........",
            "....11111111........",
            "...111111111........",
            "...1w41111w4........",
            "...111111111........",
            "...1115511111.......",
            "....11111111........",
            "...111111111........",
            "...111111111........",
            "...111111111........",
            "...111111111.11.....",
            "....1111111.1111....",
            ".....33..33..111....",
            ".....3....3..11.....",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        dokudama: {
          palette: { 4: "#CE93D8" },
          grid: [
            "....................",
            "....................",
            "......2222..........",
            ".....111111.........",
            "....11311111........",
            "...1111111111.......",
            "...1w11111w11.......",
            "...111111111........",
            "...111111111........",
            "...1111111311.......",
            "...111111111........",
            "....11111111........",
            ".....111111.........",
            "......1111..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        dokunuma: {
          palette: { 4: "#C03028" },
          grid: [
            "....................",
            "......1111..........",
            ".....111111.........",
            "....111111111.......",
            "...1w41111w411......",
            "...11111111111......",
            "...11111111111......",
            "....111111111.......",
            "...1111111111.......",
            "..111111111111......",
            "..111111111111......",
            "..111111111111......",
            "...111111111........",
            "..22222222222222....",
            "..22222222222222....",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        kawadojou: {
          palette: {},
          grid: [
            "....................",
            "....................",
            "....................",
            "....................",
            "....111111..........",
            "...11111111.........",
            "..1w111w1111111.....",
            "..11111111111111....",
            "..111111111111111...",
            "..1111111111111111..",
            "..11111111111133311.",
            "...1111111111.333...",
            "....111111111.......",
            ".....2222222........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        hidane: {
          palette: { 4: "#FFCC00", 5: "#FF6030" },
          grid: [
            ".......55...........",
            "......5553..........",
            ".......11...........",
            "......1111..........",
            ".....111111.........",
            ".....1w11w1.........",
            ".....111111.........",
            ".....114411.........",
            "......1111..........",
            ".....111111.........",
            ".....111111.........",
            ".....111111.........",
            "......1111..........",
            "......3333..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        kaenjishi: {
          palette: { 4: "#FF8040", 5: "#FF6030" },
          grid: [
            ".....44444..........",
            "....4444444.........",
            "...444444444........",
            "...441111144........",
            "..4411111114........",
            "..441w5111w5........",
            "..4411111114........",
            "...411111114........",
            "....11111111........",
            "...111111111........",
            "..1111111111........",
            "..1111111111........",
            "..1111111111........",
            "..33.111111.33......",
            "..3...3333...3......",
            "......3..3..........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        tsuchikobushi: {
          palette: {},
          grid: [
            "....................",
            "......1111..........",
            ".....111111.........",
            "....11111111........",
            "....1w1111w1........",
            "....11111111........",
            "....11111111........",
            ".....111111.........",
            "...3111111113.......",
            "...31111111113......",
            "....11111111........",
            "...1111111111.......",
            "...1111111111.......",
            "...1111111111.......",
            "....11111111........",
            ".....33..33.........",
            ".....3....3.........",
            "....................",
            "....................",
            "....................",
          ],
        },
        iwakenjin: {
          palette: { 4: "#C03028" },
          grid: [
            ".....1111...........",
            "....111111..........",
            "...11111111.........",
            "...1w41111w4........",
            "...11111111.........",
            "....111111..........",
            "..2211111122........",
            "..22111111222.......",
            "..2211111112........",
            "...111111111........",
            "..11111111111.......",
            "..11111111111.......",
            "..11111111111.......",
            "..11111111111.......",
            "..33.111111.33......",
            "..33..3333..33......",
            "......3..3..........",
            "......3..3..........",
            "....................",
            "....................",
          ],
        },
        mogurakko: {
          palette: { 4: "#FFB6C1" },
          grid: [
            "....................",
            "....................",
            "......1111..........",
            ".....111111.........",
            "....11111111........",
            "....1--111--........",
            "....11111111........",
            "....11144111........",
            ".....111111.........",
            "..33111111133.......",
            ".333.11111.333......",
            ".33..11111..33......",
            "......1111..........",
            "......1111..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        dogou: {
          palette: { 4: "#B8B8D0" },
          grid: [
            ".....2222...........",
            "....222222..........",
            "...11111111.........",
            "...1w41111w4........",
            "...11111111.........",
            "...11141111.........",
            "....111111..........",
            "...111111111........",
            "..1111111111........",
            "..11111111111.......",
            "..11111111111.......",
            "..11111111111.......",
            "..11111111111.......",
            "..33111111133.......",
            "..33..1111.33.......",
            "......3333..........",
            "......33.33.........",
            "......3...3.........",
            "....................",
            "....................",
          ],
        },
        yurabi: {
          palette: { 4: "#FF4444", 5: "#FFCCCC" },
          grid: [
            "....................",
            "....................",
            ".....111111.........",
            "....11111111........",
            "...1111111111.......",
            "...114511145........",
            "...1111111111.......",
            "...1111111111.......",
            "....11111111........",
            "....11111111........",
            "....11111111........",
            "...1111111111.......",
            "...11111111111......",
            "...1.111111.11......",
            "......1..1..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        kageboushi: {
          palette: { 4: "#F85888", 5: "#FFF" },
          grid: [
            "......22............",
            ".....2222...........",
            "....111111..........",
            "...1111111111.......",
            "...11111111111......",
            "..114511114511......",
            "..111111111111......",
            "..111111111111......",
            "...1111111111.......",
            "...1111111111.......",
            "...1111111111.......",
            "...11111111111......",
            "..111111111111......",
            "..1.1111111.11......",
            ".....11..11.........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        yomikagura: {
          palette: { 4: "#F85888", 5: "#FFF" },
          grid: [
            ".....2222...........",
            "....222222..........",
            "...11111111.........",
            "..1111111111........",
            "..11111111111.......",
            ".1145111114511......",
            ".11111111111111.....",
            ".11111111111111.....",
            "..111112111111......",
            "..111111111111......",
            "..111111111111......",
            "..1111111111111.....",
            ".11111111111111.....",
            ".1.11111111.111.....",
            "...11.11.11.11......",
            "....1....1..........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        hanausagi: {
          palette: { 4: "#FF69B4", 5: "#FFB6C1", 6: "#F85888" },
          grid: [
            "....14....41........",
            "...114...411........",
            "...1111.1111........",
            "....11111111........",
            "...111111111........",
            "...1w61111w6........",
            "...111111111........",
            "...111551111........",
            "....11111111........",
            "...111111111........",
            "...111111111........",
            "...111111111........",
            "....11111111........",
            ".....111111.........",
            "......3333..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        tsukiusagi: {
          palette: { 4: "#E1BEE7", 5: "#F85888" },
          grid: [
            "...114....411.......",
            "...114...4111.......",
            "...11111.11111......",
            "....111111111.......",
            "...1111111111.......",
            "...1w51111w51.......",
            "...11111111111......",
            "...11111111111......",
            "....1112211111......",
            "...11111111111......",
            "...11111111111......",
            "...11111111111......",
            "....111111111.......",
            ".....1111111........",
            "......33..33........",
            "......3....3........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        kanamori: {
          palette: {},
          grid: [
            "....................",
            ".....111111.........",
            "....11111111........",
            "...1111111111.......",
            "...1w11111w11.......",
            "...1111111111.......",
            "...1111111111.......",
            "..111111111111......",
            "..111111111111......",
            "..11133333311.......",
            "..111111111111......",
            "..11133333311.......",
            "..111111111111......",
            "..11133333311.......",
            "..111111111111......",
            "...1111111111.......",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        kusakabi: {
          palette: { 4: "#A040A0", 5: "#78C850" },
          grid: [
            ".......55...........",
            "......5555..........",
            ".....111111.........",
            "....11111111........",
            "....1w41111w........",
            "....11111111........",
            "....11411111........",
            ".....111111.........",
            "....11111111........",
            "....11111111........",
            "....11111111........",
            "....11111111........",
            ".....111111.........",
            "......1111..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        dokubana: {
          palette: { 4: "#CE93D8", 5: "#BA68C8", 6: "#A040A0" },
          grid: [
            ".....44544..........",
            "....4454544.........",
            ".....445544.........",
            "....11111111........",
            "...1111111111.......",
            "...1w61111w61.......",
            "...11111111111......",
            "...11111111111......",
            "....111111111.......",
            "..2111111111112.....",
            "..21111111111.2.....",
            "...1111111111.......",
            "...1111111111.......",
            "....11111111........",
            ".....33..33.........",
            ".....3....3.........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        yamigarasu: {
          palette: { 4: "#FF4444", 5: "#FFF", 6: "#F8D030" },
          grid: [
            "......111...........",
            ".....11111..........",
            "....1111111.........",
            "....14511451........",
            "....11161111........",
            ".....111111.........",
            "..1111111111........",
            ".111111111111.......",
            ".111111111111.......",
            ".111.111111.111.....",
            "......11111.........",
            ".....111111.........",
            ".....111111.........",
            "......1111..........",
            "......3333..........",
            "......3..3..........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        yukiusagi: {
          palette: { 4: "#B3E5FC", 5: "#6890F0", 6: "#E1F5FE" },
          grid: [
            "....11....11........",
            "...111...111........",
            "...1111.1111........",
            "....11111111........",
            "...111111111........",
            "...1w51111w5........",
            "...111111111........",
            "...111441111........",
            "....11111111........",
            "...111611111........",
            "...111111111........",
            "...111111111........",
            "....11111111........",
            ".....111111.........",
            "......3333..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        koorigitsune: {
          palette: { 4: "#EE99AC", 5: "#E1F5FE" },
          grid: [
            "...11.....11........",
            "...111...111........",
            "....111.111.........",
            "....11111111........",
            "...1111111111.......",
            "...1w41111w41.......",
            "...11111111111......",
            "...11111111111......",
            "....111111111.......",
            "...111111111........",
            "...1111111111.......",
            "...1111111111.11....",
            "....11111111.1111...",
            ".....111111..111....",
            "......33.33.........",
            "......3...3.........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        kogoriiwa: {
          palette: { 4: "#6890F0" },
          grid: [
            "....................",
            "......2222..........",
            ".....222222.........",
            "....11111111........",
            "...1111111111.......",
            "...1111111111.......",
            "...1w41111w41.......",
            "...1111111111.......",
            "...1111111111.......",
            "..111111111111......",
            "..11133333311.......",
            "..111111111111......",
            "..11133333311.......",
            "..111111111111......",
            "..111111111111......",
            "...1111111111.......",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        tatsunoko: {
          palette: { 4: "#7038F8", 5: "#9370DB" },
          grid: [
            ".....33.33..........",
            "......1111..........",
            ".....111111.........",
            "....11111111........",
            "....1w41111w........",
            "....11111111........",
            "....11111111........",
            ".....111111.........",
            "....11111111........",
            "....11111111........",
            "....11111111........",
            "....11111111.33.....",
            ".....111111.3333....",
            "......3333..333.....",
            "......3..3..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        ryuubi: {
          palette: { 4: "#7038F8", 5: "#9370DB" },
          grid: [
            "....33..33..........",
            ".....11111..........",
            "....11111111........",
            "...1111111111.......",
            "...1w41111w41.......",
            "...11111111111......",
            "...11111111111......",
            "....111111111.......",
            "..221111111122......",
            "..22111111112.......",
            "...1111111111.......",
            "...11111111113......",
            "...1111111111333....",
            "....11111111.33.....",
            ".....33..33.........",
            ".....3....3.........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        ryuujin: {
          palette: { 4: "#7038F8", 5: "#9370DB" },
          grid: [
            "...33....33.........",
            "....111111..........",
            "...1111111111.......",
            "..11111111111.......",
            "..1w41111w411.......",
            "..111111111111......",
            "..111111111111......",
            "...111111111........",
            ".2211111111122......",
            ".221111111111222....",
            "..211111111111.2....",
            "..111111111111......",
            "..11111111111133....",
            "..1111111111113333..",
            "..33111111133.33....",
            "..33..3333..33......",
            "......3..3..........",
            "......3..3..........",
            "....................",
            "....................",
          ],
        },
        kiokudama: {
          palette: { 4: "#F85888", 5: "#FFB6C1" },
          grid: [
            "....................",
            "....................",
            ".....222222.........",
            "....11111111........",
            "...1111111111.......",
            "...111211111........",
            "...1w41111w4........",
            "...1111111111.......",
            "...1111111111.......",
            "....11111111........",
            "...1151111151.......",
            "...1111111111.......",
            "....11111111........",
            ".....111111.........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        omoidama: {
          palette: { 4: "#EE99AC", 5: "#FFB6C1" },
          grid: [
            ".....222222.........",
            "....22222222........",
            "...1112211111.......",
            "..11111111111.......",
            "..111211111111......",
            "..1w41111w411.......",
            "..111111111111......",
            "..111111111111......",
            "...111111111111.....",
            "...111111111111.....",
            "....1151111151......",
            "....11111111111.....",
            ".....111111111......",
            "......1111111.......",
            "......11..11........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        haganedake: {
          palette: { 4: "#7038F8" },
          grid: [
            ".......22...........",
            "......2222..........",
            ".....111111.........",
            "....11111111........",
            "...1111111111.......",
            "...1w41111w41.......",
            "...1111111111.......",
            "...1111111111.......",
            "..111111111111......",
            "..11133333311.......",
            "..111111111111......",
            "..11133333311.......",
            "..111111111111......",
            "..111111111111......",
            "...1111111111.......",
            "....11111111........",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        kurooni: {
          palette: { 4: "#FF4444", 5: "#FFF" },
          grid: [
            ".....33..33.........",
            "....11111111........",
            "...1111111111.......",
            "...1145111451.......",
            "...1111111111.......",
            "....11111111........",
            "...111111111........",
            "..11111111111.......",
            "..11111111111.......",
            "..11111111111.......",
            "..11111111111.......",
            "..11111111111.......",
            "..11111111111.......",
            "..33111111133.......",
            "..33..3333.33.......",
            "......3..3..........",
            "......3..3..........",
            "....................",
            "....................",
            "....................",
          ],
        },
        fubukirei: {
          palette: { 4: "#98D8D8", 5: "#FFF", 6: "#E1F5FE" },
          grid: [
            "......66............",
            ".....1111...........",
            "....11111111........",
            "...1111111111.......",
            "...11111111111......",
            "..114511114511......",
            "..111111111111......",
            "..111111111111......",
            "...111161111........",
            "...1111111111.......",
            "...1111111111.......",
            "...11111111111......",
            "..111111111111......",
            "..1.1111111.11......",
            ".....11..11.........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        umihebi: {
          palette: { 4: "#7038F8" },
          grid: [
            "....................",
            ".....22.22..........",
            "....111111..........",
            "...11111111.........",
            "..1w411w4111........",
            "..1111111111........",
            "..11111111111.......",
            "...111111111111.....",
            "...1111111111111....",
            "....11111111111111..",
            ".....111111111.333..",
            "......111111113333..",
            ".......11111111.33..",
            "........1111111.....",
            ".........22222......",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        denjimushi: {
          palette: { 4: "#FFEB3B", 5: "#F8D030" },
          grid: [
            "....................",
            ".......44...........",
            "......4444..........",
            "......1111..........",
            ".....111111.........",
            "....11111111........",
            "....1w51111w........",
            "....11111111........",
            "....11111111........",
            ".....111111.........",
            "...3111111113.......",
            "..33.111111.33......",
            "..3..111111..3......",
            ".....111111.........",
            "......1111..........",
            "....................",
            "....................",
            "....................",
            "....................",
            "....................",
          ],
        },
        raijindou: {
          palette: { 4: "#FFEB3B", 5: "#F8D030" },
          grid: [
            "....44....44........",
            "...444..4444........",
            "....11111111........",
            "...1111111111.......",
            "..11111111111.......",
            "..1w51111w511.......",
            "..111111111111......",
            "..111111111111......",
            "...1114411111.......",
            "..111111111111......",
            "..111111111111......",
            "..111111111111......",
            "..111111111111......",
            "..33111111133.......",
            "..33..3333.33.......",
            "......3..3..........",
            "......3..3..........",
            "....................",
            "....................",
            "....................",
          ],
        },
        omoide: {
          palette: { 4: "#F85888", 5: "#FFB6C1", 6: "#EE99AC" },
          grid: [
            "....2222222222......",
            "...222222222222.....",
            "..22222222222222....",
            "..22111222111222....",
            "..2211111111112.....",
            "..221w41111w412.....",
            "..22111111111122....",
            "..22111111111122....",
            "...2111161111122....",
            "...2111111111112....",
            "...22111111111122...",
            "...221115511112.....",
            "....22111111122.....",
            "....221111111122....",
            ".....2111111112.....",
            "......21111112......",
            "......11..1111......",
            ".......1...11.......",
            "....................",
            "....................",
          ],
        },
        wasurenu: {
          palette: { 4: "#FF4444", 5: "#FFF", 6: "#705848" },
          grid: [
            "...66.222222.66.....",
            "...6622222222.6.....",
            "....111111111.......",
            "...11111111111......",
            "..111111111111......",
            "..114511114511......",
            "..111111111111......",
            "..111111111111......",
            "...1111111111.......",
            "...1111111111.......",
            "..33111111113.......",
            "..331111111113......",
            "..33111111111.......",
            "...11111111111......",
            "...1.1111111.1......",
            "......11..11........",
            ".......1...1........",
            "....................",
            "....................",
            "....................",
          ],
        },
      };

      function renderSpriteSVG(id, types) {
        const sprite = SPRITE_DATA[id];
        if (!sprite) return "";

        const primary = getTypeColor(types);
        const secondary = getSecondaryColor(types);
        const dark = darkenColor(primary, 40);
        const colorMap = {
          1: primary,
          2: secondary,
          3: dark,
          w: "#FFFFFF",
          "-": "#333333",
        };
        Object.assign(colorMap, sprite.palette);

        let rects = "";
        for (let y = 0; y < sprite.grid.length; y++) {
          const row = sprite.grid[y];
          for (let x = 0; x < row.length; x++) {
            const ch = row[x];
            if (ch === ".") continue;
            const color = colorMap[ch];
            if (!color) continue;
            rects += `<rect x="${x}" y="${y}" width="1" height="1" fill="${color}"/>`;
          }
        }

        return `<svg viewBox="0 0 20 20" width="72" height="72" style="image-rendering:pixelated">${rects}</svg>`;
      }

      // ─── Monster Data (fetched from monsters.json) ───
      let monsters = [];

      async function init() {
        const res = await fetch("./monsters.json");
        monsters = await res.json();
        buildFilterButtons();
        renderGrid();
      }

      // ─── Render ───
      const grid = document.getElementById("monsterGrid");
      const filterBar = document.getElementById("filterBar");

      let activeFilter = "all";

      function buildFilterButtons() {
        const typesList = ["all", ...Object.keys(TYPE_LABEL)];
        typesList.forEach((t) => {
          const btn = document.createElement("button");
          btn.className = "filter-btn" + (t === "all" ? " active" : "");
          btn.textContent = t === "all" ? "すべて" : TYPE_LABEL[t];
          if (t !== "all") btn.style.borderColor = TYPE_HEX[t] + "80";
          btn.onclick = () => {
            activeFilter = t;
            document.querySelectorAll(".filter-btn").forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            renderGrid();
          };
          filterBar.appendChild(btn);
        });
      }

      function getStatColor(val) {
        if (val >= 100) return "#34D399";
        if (val >= 70) return "#FBBF24";
        return "#EF4444";
      }

      function getStatClass(val) {
        if (val >= 100) return "stat-high";
        if (val >= 70) return "stat-mid";
        return "stat-low";
      }

      function renderGrid() {
        const filtered =
          activeFilter === "all"
            ? monsters
            : monsters.filter((m) => m.types.includes(activeFilter));

        if (filtered.length === 0) {
          grid.innerHTML = '<div class="empty">該当するモンスターがいません</div>';
          return;
        }

        grid.innerHTML = filtered
          .map((m, i) => {
            const total = Object.values(m.stats).reduce((a, b) => a + b, 0);
            const statLabels = ["HP", "ATK", "DEF", "SpA", "SpD", "SPD"];
            const statKeys = ["hp", "atk", "def", "spAtk", "spDef", "speed"];

            const statsHTML = statKeys
              .map((k, j) => {
                const v = m.stats[k];
                const pct = Math.min(100, (v / 160) * 100);
                return `<div class="stat">
        <div class="stat-label">${statLabels[j]}</div>
        <div class="stat-value ${getStatClass(v)}">${v}</div>
        <div class="stat-bar"><div class="stat-fill" style="width:${pct}%;background:${getStatColor(v)}"></div></div>
      </div>`;
              })
              .join("");

            const typesHTML = m.types
              .map(
                (t) =>
                  `<span class="type-badge" style="background:${TYPE_HEX[t]}">${TYPE_LABEL[t]}</span>`,
              )
              .join("");

            const evoHTML =
              m.evo.length > 0
                ? `<div class="evolution"><span class="evo-arrow">→</span> <span class="evo-name">${m.evo[0].name}</span> (Lv.${m.evo[0].lv})</div>`
                : "";

            const legendBadge = m.legendary ? '<div class="legend-badge">LEGEND</div>' : "";

            return `<div class="card${m.legendary ? " legendary" : ""}" style="animation-delay:${i * 0.03}s">
      ${legendBadge}
      <div class="card-top">
        <div class="sprite-container">${renderSpriteSVG(m.id, m.types)}</div>
        <div class="card-info">
          <div class="card-number">No.${String(m.num).padStart(3, "0")}</div>
          <div class="card-name">${m.name}</div>
          <div class="card-id">${m.id}</div>
          <div class="types">${typesHTML}</div>
        </div>
      </div>
      <div class="stats">${statsHTML}</div>
      <div class="stat-total">合計 <span>${total}</span></div>
      ${evoHTML}
    </div>`;
          })
          .join("");
      }

      init();
    </script>
  </body>
</html>
